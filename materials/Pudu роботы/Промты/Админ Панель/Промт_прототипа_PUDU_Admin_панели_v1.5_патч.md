# Промт-патч v1.5: Панель администрирования роботов PUDU в iikoWeb

---
**Версия**: 1.5
**Дата**: 2026-02-17
**Автор**: Кирилл Тюрин (системный аналитик)
**Статус**: [PENDING]
**Артефакт**: Д3-патч (Промт-патч для обновления прототипа iikoWeb)
**Базовый документ**: Промт_прототипа_PUDU_Admin_панели_v1.4_патч.md (v1.4, 2026-02-16)
**Источники**: SPEC-002 v1.13 (разделы 2.6.4, 2.6.4a, 2.7.8); НВ #24 → CLOSED; НВ-Б5-EDIT → CLOSED; стенограмма 06.02 (Олег, NE); стенограмма 11.02 (Кирилл)
**Scope**: Синхронизация `after_action` с NE API (Э1); удаление `phrase_later` из сценария cleanup (Э4); inline-edit имени робота (Э1)
---

## Назначение

Этот документ — **дельта-патч** к промту v1.4. Он описывает изменения двух категорий:

1. **G1–G3**: Синхронизация per-robot настройки `after_action` с NE API (SPEC-002 v1.12.1, НВ #24 → CLOSED)
2. **G4–G7**: Удаление фразы «приеду позже» (`phrase_later`) из сценария cleanup — робот не имеет датчиков для определения, положил ли гость посуду (встреча 06.02: Олег (NE) подтвердил отсутствие доступа к ИК-датчикам; встреча 11.02: Кирилл зафиксировал как рудимент)
3. **G8–G11**: Inline-редактирование имени робота (`robot_name`) на экране Э1 (Б5) — клик по ячейке превращает текст в UiInput (SPEC-002 v1.13, раздел 2.6.4a)

**Инструкция по применению**: сначала примени базовый промт `Промт_прототипа_PUDU_Admin_панели.md` (v1.1), затем патчи v1.2, v1.3, v1.4 и затем этот патч v1.5 — последовательно.

**Ключевые изменения v1.5:**
- Toast #8 (`after_action` смена) — текст обновлён под SPEC-002 v1.12.1
- Новый Toast #11 — warning при недоступности NE API (стратегия write-through с soft-fail)
- Удалены поля `phrase_later` / `phrase_later_url` из типа, mock-данных и UI вкладки cleanup (Э4)
- Добавлен Info-блок с обоснованием ограничения (отсутствие датчиков)
- **Inline-edit имени робота** на Э1 (Б5) — клик по ячейке → UiInput, Enter/Blur → сохранение, Escape → отмена (SPEC-002 v1.13, §2.6.4a)
- Новые Toast #12 «Имя робота обновлено», #13 валидация (1–64 символа)

---

## Совместимость с предыдущими патчами

| Патч           | Совместимость | Примечание                         |
| -------------- | ------------- | ---------------------------------- |
| v1.1 (базовый) | Требуется     | Экран Э1 с `after_action` UiSelect |
| v1.2 (C1–C10)  | Требуется     | —                                  |
| v1.3 (E1–E5)   | Требуется     | —                                  |
| v1.4 (F1–F13)  | Требуется     | Tooltips и двухуровневая навигация |

---

## Перечень изменений v1.5

| #       | Изменение                                 | Область | Причина                                                           |
| ------- | ----------------------------------------- | ------- | ----------------------------------------------------------------- |
| **G1**  | Toast #8 — обновление текста              | Э1 (Б5) | SPEC-002 v1.12.1: текст изменён на «Настройка сохранена»          |
| **G2**  | Новый Toast #11 — NE API warning          | Э1 (Б5) | SPEC-002 v1.12.1: soft-fail при недоступности NE (HTTP 502)       |
| **G3**  | Mock-обработка ответа API `after_action`  | Э1 (Б5) | Демонстрация двух сценариев: успех (200) и NE недоступен (502)    |
| **G4**  | УДАЛИТЬ `phrase_later` из интерфейса типа | Э4 (Б3) | Нет доступа к ИК-датчикам робота → триггер фразы не существует    |
| **G5**  | УДАЛИТЬ `phrase_later` из mock-данных     | Э4 (Б3) | Синхронизация mock с удалённым полем                              |
| **G6**  | УДАЛИТЬ UI-поля фразы «приеду позже»      | Э4 (Б3) | Удаление строк 4–5 из таблицы полей ручного режима                |
| **G7**  | ДОБАВИТЬ Info-блок ограничения датчиков   | Э4 (Б3) | Пояснение для пользователя: почему поле отсутствует               |
| **G8**  | Столбец «Имя робота» → inline-edit        | Э1 (Б5) | SPEC-002 v1.13: клик по ячейке → UiInput, Enter/Blur → сохранение |
| **G9**  | Toast #12 «Имя робота обновлено»          | Э1 (Б5) | Успешное переименование (PUT 200)                                 |
| **G10** | Toast ошибок inline-edit (400/404/500)    | Э1 (Б5) | Откат + toast при ошибке API                                      |
| **G11** | Mock inline-edit поведение                | Э1 (Б5) | Демонстрация 6 шагов inline-edit в прототипе                      |

---

## G1. Toast #8 — обновление текста

### Экран Э1 (Б5), файл `app/robots/page.tsx`

### ИЗМЕНИТЬ обработчик `onValueChange` UiSelect `after_action`:

**Было (v1.4):**
```tsx
toast({ description: "Настройка робота обновлена" });
```

**Стало (v1.5):**
```tsx
// Сценарий: бэкенд сохранил локально + NE ответил 200
toast({ description: "Настройка сохранена" });
```

**Причина**: SPEC-002 v1.12.1, раздел 2.6.4 — код 200: Toast «Настройка сохранена» (3 сек).

---

## G2. Новый Toast #11 — NE API warning

### ДОБАВИТЬ новый Toast (warning) для mock-демонстрации soft-fail:

```tsx
// Сценарий: бэкенд сохранил локально, но NE вернул 502/503
toast({
  variant: "warning",                                    // оранжевый стиль
  description: "Сервис NE временно недоступен. Настройка сохранена локально",
  duration: 4000,
});
```

**Примечание**: В реальном приложении бэкенд возвращает HTTP 200 с телом `{ "warning": "ne_unavailable" }` или HTTP 502. Прототип может показывать этот Toast при клике с зажатым Alt (mock) или через mock-переключатель «Симуляция ошибки NE».

---

## G3. Mock-обработка ответа API `after_action`

### ДОБАВИТЬ mock-логику переключения между success/warning сценариями:

В файле `app/robots/page.tsx`, рядом с обработчиком `onValueChange` UiSelect `after_action`, добавить mock-переключатель:

```tsx
// Mock: имитация ответа бэкенда
const [mockNeAvailable, setMockNeAvailable] = useState(true);

// В обработчике onValueChange:
const handleAfterActionChange = (robotId: string, value: string) => {
  // Обновить локальный state (имитация сохранения в БД)
  setRobots(prev => prev.map(r =>
    r.id === robotId ? { ...r, after_action: value } : r
  ));

  if (mockNeAvailable) {
    // Сценарий 1: NE доступен (HTTP 200)
    toast({ description: "Настройка сохранена" });
  } else {
    // Сценарий 2: NE недоступен (HTTP 502) — soft-fail
    toast({
      variant: "warning",
      description: "Сервис NE временно недоступен. Настройка сохранена локально",
      duration: 4000,
    });
  }
};
```

### ДОБАВИТЬ переключатель в dev-toolbar (необязательно):

```tsx
{/* Mock-переключатель (для демонстрации, можно скрыть) */}
<div className="flex items-center gap-2 text-xs text-gray-400 px-6 pb-2">
  <Switch
    checked={mockNeAvailable}
    onCheckedChange={setMockNeAvailable}
    id="mock-ne"
    className="h-4 w-8"
  />
  <label htmlFor="mock-ne">NE API доступен (mock)</label>
</div>
```

**Причина**: Позволяет демонстрировать оба сценария работы `after_action` при presentations:
- Включён → «Настройка сохранена» (default toast, 3 сек)
- Выключен → «Сервис NE временно недоступен. Настройка сохранена локально» (warning toast, 4 сек)

---

## G4. УДАЛИТЬ `phrase_later` и `phrase_later_url` из TypeScript interface

> **Источник**: Встреча 06.02 — Олег (NE): *«У нас нет доступа к его инфракрасным датчикам. Прямо сейчас это всё решается тайм-аутом.»*  
> **Подтверждение**: Встреча 11.02 — Кирилл: *«Здесь рудимент остался. Нет доступа к сканеру, когда положили посуду или нет. Этой фразы не будет.»*

### Экран Э4 (Б3), файл `app/settings/page.tsx`

### УДАЛИТЬ из интерфейса `ScenarioSettings.cleanup` (определён в v1.2 C8):

**Было (v1.2):**
```typescript
cleanup: {
    mode: "manual" | "auto" | "mixed";
    phrase_arrival: string;          // max 180
    phrase_arrival_url?: string;     // URL видео/аудио
    wait_time: number;               // секунды
    phrase_later: string;            // max 180
    phrase_later_url?: string;       // URL видео/аудио
    auto_timer_after_delivery: number;
    auto_timer_after_check: number;
  };
```

**Стало (v1.5):**
```typescript
cleanup: {
    mode: "manual" | "auto" | "mixed";
    phrase_arrival: string;          // max 180
    phrase_arrival_url?: string;     // URL видео/аудио
    wait_time: number;               // секунды
    // phrase_later — УДАЛЕНО (v1.5 G4): нет доступа к ИК-датчикам робота,
    // робот не может определить, положил ли гость посуду.
    // Решается тайм-аутом (wait_time): робот стоит N секунд и уезжает.
    auto_timer_after_delivery: number;
    auto_timer_after_check: number;
  };
```

**Причина**: Робот PUDU не имеет доступных через API датчиков для определения нагрузки на полки. Текущее ограничение API PUDU Cloud (подтверждено NE). Поле `phrase_later` предполагало триггер «гость НЕ положил посуду», который технически невозможен. Поведение по тайм-ауту: робот стоит `wait_time` секунд и уезжает безусловно.

---

## G5. УДАЛИТЬ `phrase_later` и `phrase_later_url` из mock-данных

### ИЗМЕНИТЬ `mockSettings.cleanup` (определён в v1.2 C8):

**Было (v1.2):**
```typescript
cleanup: {
    mode: "manual",
    phrase_arrival: "Пожалуйста, поставьте грязную посуду на поднос",
    phrase_arrival_url: "",
    wait_time: 90,
    phrase_later: "Я приеду позже за посудой",
    phrase_later_url: "",
    auto_timer_after_delivery: 12,
    auto_timer_after_check: 3
  },
```

**Стало (v1.5):**
```typescript
cleanup: {
    mode: "manual",
    phrase_arrival: "Пожалуйста, поставьте грязную посуду на поднос",
    phrase_arrival_url: "",
    wait_time: 90,
    // phrase_later — УДАЛЕНО (v1.5 G5)
    auto_timer_after_delivery: 12,
    auto_timer_after_check: 3
  },
```

---

## G6. УДАЛИТЬ UI-поля фразы «приеду позже» из таблицы настроек cleanup

### ИЗМЕНИТЬ таблицу полей секции «Ручной режим» вкладки cleanup (Э4, определена в v1.2 C5):

**Было (v1.2) — 5 строк:**

| #   | Label                        | Контрол        | Default | Подсказка                                                           | Валидация |
| --- | ---------------------------- | -------------- | ------- | ------------------------------------------------------------------- | --------- |
| 1   | Фраза при подъезде к столу   | PhraseInput    | —       | «Фраза робота при прибытии к столу для уборки. Макс. 180 символов»  | max 180   |
| 2   | URL видео/аудио              | Input (url)    | —       | «Ссылка на mp4/mp3 для фразы при уборке»                            | URL       |
| 3   | Время ожидания у стола (сек) | Input (number) | 60      | «Сколько секунд робот ожидает, пока гость положит посуду»           | > 0       |
| 4   | Фраза «приеду позже»         | PhraseInput    | —       | «Фраза, если гость не положил посуду по истечении времени ожидания» | max 180   |
| 5   | URL видео/аудио              | Input (url)    | —       | «Ссылка на mp4/mp3 для фразы "приеду позже"»                        | URL       |

**Стало (v1.5) — 3 строки:**

| #   | Label                        | Контрол        | Default | Подсказка                                                          | Валидация |
| --- | ---------------------------- | -------------- | ------- | ------------------------------------------------------------------ | --------- |
| 1   | Фраза при подъезде к столу   | PhraseInput    | —       | «Фраза робота при прибытии к столу для уборки. Макс. 180 символов» | max 180   |
| 2   | URL видео/аудио              | Input (url)    | —       | «Ссылка на mp4/mp3 для фразы при уборке»                           | URL       |
| 3   | Время ожидания у стола (сек) | Input (number) | 90      | «Сколько секунд робот ожидает у стола, затем уезжает безусловно»   | > 0       |

> **Warning**: Строки 4–5 (фраза «приеду позже» + URL) **удалены**. Робот не может определить, положил ли гость посуду — нет доступа к инфракрасным датчикам через API PUDU Cloud (подтверждено NE, 06.02.2026). Поведение: робот стоит `wait_time` секунд и уезжает безусловно.

### ОБНОВИТЬ подсказку поля «Время ожидания» (строка 3):

**Было (v1.2):** `«Сколько секунд робот ожидает, пока гость положит посуду»`  
**Стало (v1.5):** `«Сколько секунд робот ожидает у стола, затем уезжает безусловно»`

Обоснование: прежняя подсказка подразумевала, что робот «знает» о факте загрузки. Новая формулировка корректно отражает поведение по тайм-ауту.

### ОБНОВИТЬ default `wait_time` (строка 3):

**Было (v1.1 base):** `60`  
**Стало (v1.5):** `90` (синхронизация с mock-данными v1.2 и SPEC-003)

### ОБНОВИТЬ таблицу условной видимости секций (определена в v1.2 C5):

**Было (v1.2):**

| Режим          | Секция «Ручной» (фраза, время, фраза «позже») | Секция «Авто» (таймеры) |
| -------------- | --------------------------------------------- | ----------------------- |
| Ручной         | Видна                                         | Скрыта                  |
| Автоматический | Скрыта, но **наследуется** (подсказка)        | Видна                   |
| Смешанный      | Видна                                         | Видна                   |

**Стало (v1.5):**

| Режим          | Секция «Ручной» (фраза, время ожидания) | Секция «Авто» (таймеры) |
| -------------- | --------------------------------------- | ----------------------- |
| Ручной         | Видна                                   | Скрыта                  |
| Автоматический | Скрыта, но **наследуется** (подсказка)  | Видна                   |
| Смешанный      | Видна                                   | Видна                   |

---

## G7. ДОБАВИТЬ Info-блок ограничения датчиков

### ДОБАВИТЬ: UiAlert (info) в секцию «Ручной режим» вкладки cleanup, Э4

Добавить **после** поля #3 (Время ожидания у стола) и **перед** секцией «Автоматический режим»:

```tsx
<UiAlert variant="info" className="mt-4">
  <Info className="h-4 w-4" />
  <AlertDescription className="text-xs text-gray-600">
    Робот стоит у стола заданное время и уезжает безусловно.
    Определение факта загрузки посуды недоступно (ограничение API PUDU).
  </AlertDescription>
</UiAlert>
```

**Стилизация**: `border-blue-200 bg-blue-50`, иконка `Info` из Lucide, текст `text-xs text-gray-600`.

**Причина**: Чтобы администратор понимал, почему отсутствует настройка фразы «приеду позже» и как работает тайм-аут.

---

## G8. Столбец «Имя робота» → inline-edit (Э1)

> **Источник**: SPEC-002 v1.13, раздел 2.6.4a — `PUT /api/pudu/robots/{robot_id}/name`
> **Примечание**: В v1.4 (F11) tooltip заголовка уже содержит текст «можно отредактировать», но код inline-edit не был реализован. Этот патч добавляет реализацию.

### Экран Э1 (Б5), файл `app/robots/page.tsx`

### ОБНОВИТЬ: столбец #1 «Имя робота» в таблице роботов

**Было (v1.1 base):**

| #   | Столбец    | Тип данных | Стилизация                            |
| --- | ---------- | ---------- | ------------------------------------- |
| 1   | Имя робота | string     | Обычный текст `text-sm text-gray-900` |

**Стало (v1.5):**

| #   | Столбец    | Тип данных            | Стилизация                                           |
| --- | ---------- | --------------------- | ---------------------------------------------------- |
| 1   | Имя робота | UiInput (inline-edit) | Режим отображения / режим ввода (см. поведение ниже) |

### ДОБАВИТЬ: state для inline-edit

```tsx
// v1.5 G8: State для inline-edit имени робота
const [editingRobotId, setEditingRobotId] = useState<string | null>(null);
const [editingName, setEditingName] = useState('');
const [previousName, setPreviousName] = useState('');  // для отката при ошибке
```

### ОБНОВИТЬ: рендер ячейки «Имя робота» в строке таблицы

**Было (v1.1 base):**
```tsx
<td className="px-4 py-3">
  <span className="text-sm text-gray-900">{robot.name}</span>
</td>
```

**Стало (v1.5):**
```tsx
<td className="px-4 py-3">
  {editingRobotId === robot.id ? (
    // Режим редактирования
    <Input
      value={editingName}
      onChange={(e) => setEditingName(e.target.value)}
      onKeyDown={(e) => {
        if (e.key === 'Enter') handleNameSave(robot.id);
        if (e.key === 'Escape') handleNameCancel();
      }}
      onBlur={() => handleNameSave(robot.id)}
      maxLength={64}
      autoFocus
      className="h-8 text-sm px-2 py-1 w-full max-w-[200px]"
      aria-label={`Редактирование имени робота ${robot.name}`}
    />
  ) : (
    // Режим отображения — кликабельный
    <button
      onClick={() => handleNameEdit(robot.id, robot.name)}
      className="text-sm text-gray-900 hover:text-blue-700 hover:underline
                 cursor-text text-left transition-colors"
      title="Нажмите для редактирования имени"
      aria-label={`Имя робота: ${robot.name}. Нажмите для редактирования`}
    >
      {robot.name}
    </button>
  )}
</td>
```

### ДОБАВИТЬ: обработчики inline-edit

```tsx
// v1.5 G8: Начало редактирования
const handleNameEdit = (robotId: string, currentName: string) => {
  setEditingRobotId(robotId);
  setEditingName(currentName);
  setPreviousName(currentName);
};

// v1.5 G8: Отмена редактирования (Escape)
const handleNameCancel = () => {
  setEditingRobotId(null);
  setEditingName('');
  setPreviousName('');
};

// v1.5 G8: Сохранение имени (Enter / Blur)
const handleNameSave = (robotId: string) => {
  const trimmed = editingName.trim();

  // Если не изменилось — тихо выходим
  if (trimmed === previousName) {
    handleNameCancel();
    return;
  }

  // Валидация: 1–64 символа
  if (trimmed.length === 0 || trimmed.length > 64) {
    toast({
      variant: "destructive",
      description: "Имя робота должно содержать от 1 до 64 символов",
      duration: 4000,
    });
    handleNameCancel();
    return;
  }

  // Mock: сохраняем в state (имитация PUT 200)
  setRobots(prev => prev.map(r =>
    r.id === robotId ? { ...r, name: trimmed } : r
  ));
  setEditingRobotId(null);

  // Toast: успех
  toast({ description: "Имя робота обновлено" });
};
```

### Поведение inline-edit (6 шагов, из SPEC-002 §2.6.4a)

| Шаг | Действие пользователя        | Реакция UI                                                                                                                               |
| --- | ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | Клик по ячейке «Имя»         | Ячейка превращается в UiInput (text) с текущим значением, фокус автоматический. Hover: `text-blue-700 underline` — сигнал кликабельности |
| 2   | Ввод нового имени            | Стандартный ввод. Валидация: max 64 символа (`maxLength`)                                                                                |
| 3   | Enter / Blur (потеря фокуса) | Если значение изменилось — mock PUT-запрос. Если не изменилось — тихий возврат в режим отображения                                       |
| 4   | Escape                       | Отмена редактирования, возврат к предыдущему значению без API-запроса                                                                    |
| 5   | Успешный ответ (200)         | UiInput → текст, Toast «Имя робота обновлено» (3 сек)                                                                                    |
| 6   | Ошибка (4xx/5xx)             | UiInput → текст с **предыдущим** значением (откат), Toast с текстом ошибки (4 сек)                                                       |

> **Примечание о правах**: Прототип не реализует `PUDU_VIEW` / `PUDU_EDIT`. В продакшене: для `PUDU_VIEW` клик не активирует редактирование (обычный текст, не `<button>`).

---

## G9. Toast #12 «Имя робота обновлено»

### ДОБАВИТЬ в реестр Toast-уведомлений:

| #   | Текст                  | Стиль   | Триггер                                         |
| --- | ---------------------- | ------- | ----------------------------------------------- |
| 12  | «Имя робота обновлено» | default | Inline-edit, успешное сохранение (mock PUT 200) |

---

## G10. Toast ошибок inline-edit

### ДОБАВИТЬ в реестр Toast-уведомлений (для полноты, mock в прототипе не обязателен):

| #   | Текст                                             | Стиль       | Триггер                     |
| --- | ------------------------------------------------- | ----------- | --------------------------- |
| 13  | «Имя робота должно содержать от 1 до 64 символов» | destructive | Валидация (пустое / >64)    |
| 14  | «Робот не найден»                                 | destructive | PUT 404 (робот удалён)      |
| 15  | «Ошибка сервера. Попробуйте позже»                | destructive | PUT 500 (сервер недоступен) |

> **Примечание**: В прототипе реализован только Toast #12 (успех) и #13 (валидация). Toast #14–15 — для документации полного поведения по SPEC-002.

---

## G11. Mock inline-edit — демонстрационное поведение

### Описание сценария демонстрации inline-edit:

1. Таблица роботов отображается с обычными текстовыми именами
2. Наведение на ячейку «BellaBot-01» → `text-blue-700 underline` (курсор `cursor-text`)
3. Клик → ячейка превращается в Input с текстом «BellaBot-01», автофокус
4. Ввод «Белла Зал 1» → Enter
5. Ячейка возвращается в текстовый режим: «Белла Зал 1»
6. Появляется Toast: «Имя робота обновлено» (3 сек)

### Альтернативный сценарий (Escape):

1. Клик на ячейку «Ketty-02» → Input с текстом «Ketty-02»
2. Ввод «Тест» → Escape
3. Ячейка возвращается к «Ketty-02» (без изменений, без Toast)

---

## Обновление итогового чеклиста

В дополнение к чеклисту v1.4, добавить:

- [ ] G1: Toast #8 текст обновлён: «Настройка сохранена» (3 сек, default)
- [ ] G2: Toast #11 добавлен: «Сервис NE временно недоступен. Настройка сохранена локально» (4 сек, warning)
- [ ] G3: Mock-переключатель NE availability работает корректно
- [ ] UiSelect `after_action` — оба сценария Toast отображаются при переключении mock
- [ ] G4: Поля `phrase_later` и `phrase_later_url` удалены из интерфейса `ScenarioSettings.cleanup`
- [ ] G5: Поля `phrase_later` и `phrase_later_url` удалены из mock-данных `mockSettings.cleanup`
- [ ] G6: Строки 4–5 (фраза «приеду позже» + URL) удалены из таблицы полей ручного режима
- [ ] G6: Подсказка поля «Время ожидания» обновлена: «...затем уезжает безусловно»
- [ ] G6: Default `wait_time` = 90 (синхронизация с mock и SPEC-003)
- [ ] G6: Таблица условной видимости обновлена (убрано «фраза позже»)
- [ ] G7: Info-блок (UiAlert info) добавлен после поля «Время ожидания»
- [ ] G8: Столбец «Имя робота» кликабельный, hover `text-blue-700 underline`
- [ ] G8: Клик → UiInput с текущим значением, autofocus
- [ ] G8: Enter / Blur → сохранение (если изменилось), тихий выход (если нет)
- [ ] G8: Escape → отмена без изменений
- [ ] G9: Toast #12 «Имя робота обновлено» при успешном сохранении
- [ ] G10: Toast #13 «Имя робота должно содержать от 1 до 64 символов» при валидации
- [ ] G11: Демо-сценарий inline-edit воспроизводим

---

## История изменений

| Версия | Дата       | Автор        | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------ | ---------- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1.5    | 2026-02-17 | Кирилл Тюрин | G1–G3: Патч НВ #24 — синхронизация `after_action` с NE API (Toast #8 обновлён, Toast #11 warning, mock-переключатель). G4–G7: Удаление `phrase_later` из cleanup — робот не имеет доступа к ИК-датчикам (подтверждено NE 06.02), триггер фразы невозможен. Удалены поля из типа, mock, UI; обновлена подсказка wait_time; добавлен Info-блок ограничения. G8–G11: Inline-edit имени робота на Э1 (Б5) — клик → UiInput, Enter/Blur → PUT, Escape → отмена. Toast #12 «Имя робота обновлено». Источник: SPEC-002 v1.13 §2.6.4a [НВ-Б5-EDIT]. |
