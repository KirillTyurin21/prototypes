import { ChangelogRelease } from '@/shared/changelog.types';

export const CHANGELOG: ChangelogRelease[] = [
  {
    version: '2.3',
    date: '2026-03-02',
    status: 'released',
    changes: [
      {
        page: 'POS — Регистрация (M19)',
        pageRoute: '/prototype/front-pudu-plugin/pos?modal=registration_code',
        items: [
          'Новая модалка M19: «Код регистрации» — подключение ресторана к NE Cloud',
          '6 состояний: генерация кода, код отображён (таймер TTL), код истёк, успех, ошибка, уже зарегистрирован',
          'Копирование кода, таймер обратного отсчёта, перегенерация кода',
        ],
      },
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin/catalog',
        items: [
          'Новая секция «Регистрация (Cold Registration)» — 6 ячеек для всех состояний M19',
        ],
      },
      {
        page: 'POS — Демо-панель',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Кнопка «Регистрация» и выпадающий список состояний M19 в демо-панели',
        ],
      },
    ],
  },
  {
    version: '2.2',
    date: '2026-03-02',
    status: 'released',
    changes: [
      {
        page: 'POS — Повторная доставка (М16)',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'М16 полностью переработан: упрощённый confirm-диалог «Повторить доставку?» с кнопками «Уехать» / «Повторить»',
          'Убрано отображение имени, ID и статуса робота — NE назначает свободного автоматически',
          'Кнопка «Pudu: Повторить отправку» вынесена на уровень плагинов (рядом с «Pudu: Команды»)',
          'Кнопка «Повторить отправку» видна только после выполнения хотя бы одной доставки блюд',
        ],
      },
      {
        page: 'POS — Доставка блюд',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Доставка блюд отправляется одной командой — NE самостоятельно рассчитывает рейсы и распределяет роботов',
          'Toast отправки блюд упрощён: информация о рейсах убрана (NE управляет)',
        ],
      },
      {
        page: 'POS — QR-оплата',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Добавлен toast «QR-оплата — отправлено» при создании задачи qr_payment (auto-close 10 сек)',
        ],
      },
      {
        page: 'POS — Уведомления',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Новый тип toast «Задача в очереди» — при отсутствии свободных роботов задача принимается NE в очередь',
          'Добавлена кнопка «Все заняты» в демо-панели для имитации очереди',
        ],
      },
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Обновлена ячейка М16: упрощённый confirm вместо полного окна',
          'Добавлены ячейки: toast qr_payment dispatched, toast queued (нет роботов)',
          'Обновлены ячейки send_dish dispatched (рейсы убраны)',
          'Добавлена цепочка send-dish-repeat-simple',
        ],
      },
    ],
  },
  {
    version: '2.1',
    date: '2026-03-02',
    status: 'released',
    changes: [
      {
        page: 'POS — Уведомления',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Toast «Завершено» (зелёный) полностью удалён — официант не ждёт завершения задачи роботом',
          'Toast «Отправлено» теперь автоматически закрывается через 10 секунд (крестик ручного закрытия остаётся)',
          'Toast отправки блюд показывает расширенную информацию: количество блюд и номер рейса',
        ],
      },
      {
        page: 'POS — Демо-панель',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Убраны кнопки «Completed ВКЛ/ВЫКЛ» и «Задача завершена» — уведомления завершения удалены',
        ],
      },
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Удалена ячейка «Toast: Сценарий выполнен» и сценарий «Polling: задача завершена»',
          'Обновлены ячейки dispatched-тостов с пометкой «auto-close 10s»',
          'Добавлены ячейки toast send_dish: варианты с несколькими рейсами и одним рейсом',
          'Сценарий «Fire-and-forget (полный цикл)» обновлён: отправлено вместо отправлено → завершено',
        ],
      },
      {
        items: [
          'Mock-данные: max_dishes_per_trip изменён с 4 на 2 для наглядной демонстрации рейсов',
        ],
      },
    ],
  },
  {
    version: '2.0',
    date: '2026-03-02',
    status: 'released',
    changes: [
      {
        page: 'POS — Из заказа',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Кнопки «Отправить меню», «Уборка», «Доставка блюд» теперь отправляют задачу напрямую (один клик → спиннер на кнопке → toast), без промежуточного окна подтверждения',
          'Inline-спиннер на нажатой кнопке во время отправки; остальные кнопки заблокированы',
          'Исключён выбор робота и подтверждение — NE автоматически назначает робота из очереди',
          'Toast «отправлено» больше не содержит имя робота — робот неизвестен на момент отправки',
        ],
      },
      {
        page: 'POS — Главный экран',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=main',
        items: [
          'Кнопка «Маркетинг» удалена из окна «Команды роботам» — маркетинг управляется через Admin Panel (after_action)',
          'Индикатор «Маркетинг-круиз активен» убран из обоих контекстов',
        ],
      },
      {
        page: 'Статус роботов (М18)',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=main',
        items: [
          'Таблица сокращена с 4 до 3 столбцов: убрана колонка «ID» (ID не несёт информации для пользователя)',
          'Столбец «Текущая задача» показывает русские названия: «Доставка меню», «Уборка посуды» и т.д.',
        ],
      },
      {
        page: 'Выбор робота (М17)',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Столбец «Задача» локализован — отображает русские названия вместо технических кодов',
        ],
      },
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'М1, М2, М14 (confirm-модалки) помечены как DEPRECATED — заменены fire-and-forget на POS-кнопке',
          'М17 (выбор робота П1) помечен как DEPRECATED — NE автоматически назначает робота',
          'Сценарий «Маркетинг → Выбор робота» помечен как DEPRECATED',
          'Карточка «Маркетинговый круиз» помечена как DEPRECATED',
        ],
      },
    ],
  },
  {
    version: '1.9',
    date: '2026-02-18',
    status: 'released',
    changes: [
      {
        page: 'POS — Из заказа',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'Добавлена кнопка «Дополнения → Плагины» в экран заказа (по аналогии с главным экраном)',
          'Добавлено окно «Плагины» из контекста заказа с кнопкой «Pudu: Команды»',
          'Добавлено окно «Команды роботам» из заказа с 4 кнопками: Отправить меню, Уборка посуды, Доставка блюд, Повторить отправку',
          'При нажатии на кнопки Отправить меню / Уборка / Доставка — сначала открывается окно «Выбор робота», затем соответствующая модалка',
          'Кнопка «Повторить отправку» — открывает окно «Повторить доставку» без выбора робота (возвращается тот же робот)',
        ],
      },
      {
        page: 'POS — Повторить доставку',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=order',
        items: [
          'В окне «Повторить доставку» добавлена информация о роботе: имя, ID, текущий статус',
          'Добавлено предупреждение если робот занят: «Команда будет отправлена после завершения текущей задачи»',
          'Исправлен баг: окно «Повторить доставку» больше не закрывается автоматически через 3 секунды',
          'Кнопка «Повторить» теперь всегда доступна для нажатия (убрано условие sendDishCompleted)',
        ],
      },
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Добавлены ячейки каталога: «Дополнения → Плагины (из заказа)» и «Команды роботам (из заказа)»',
        ],
      },
    ],
  },
  {
    version: '1.8',
    date: '2026-02-18',
    status: 'released',
    changes: [
      {
        page: 'Каталог состояний',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Секция «Контекст: Главный экран» перемещена выше секции «Контекст: Из заказа»',
          'Добавлены ячейки каталога: «Дополнения → Плагины» и «Команды роботам»',
        ],
      },
      {
        page: 'POS — Главный экран',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=main',
        items: [
          'Три кнопки (Маркетинг, Уборка, Статус роботов) заменены на одну кнопку «Дополнения»',
          'Добавлено окно «Плагины» — сетка прямоугольных кнопок 3×6 (стиль Front)',
          'В окне «Плагины» — кнопки «Pudu: Статус роботов» и «Pudu: Команды»',
          'Добавлено окно «Команды роботам» с кнопками «Уборка (Столы)» и «Маркетинг»',
          'Навигация: Дополнения → Плагины → выбор действия → существующие модалки',
        ],
      },
      {
        page: 'POS — Уборка: флоу выбора робота',
        pageRoute: '/prototype/front-pudu-plugin/pos?context=main',
        items: [
          'В цепочке «Дополнения → Pudu: Команды → Уборка (Столы)» перед выбором столов теперь показывается окно «Выбор робота» (статусы роботов) с кнопкой «Выбрать столы для уборки →»',
          'При клике «Уборка посуды (мультивыбор)» из каталога состояний также первым открывается окно «Выбор робота»',
          'Компонент «Статус роботов» поддерживает кастомный заголовок и подзаголовок через @Input title/subtitle',
          'Добавлена кнопка «Продолжить» (proceedLabel) в компонент «Статус роботов» для перехода к следующему шагу',
          'Исправлен баг: в режиме «Выбор робота» строки таблицы теперь кликабельны — можно выбрать робота нажав на строку',
          'Кнопка «Выбрать столы для уборки →» активна только при выбранном роботе; при неактивной кнопке: текст «Выберите робота выше»',
          'Offline-роботы некликабельны, свободный/занятой — кликабельны; выбранная строка подсвечивается акцентным цветом с галочкой',
        ],
      },
    ],
  },
  {
    version: '1.7',
    date: '2026-02-18',
    status: 'released',
    changes: [
      {
        items: [
          'Исправлено название системы в истории изменений («Front» вместо проприетарного названия)',
        ],
      },
    ],
  },
  {
    version: '1.6',
    date: '2026-02-17',
    status: 'released',
    changes: [
      {
        page: 'Настройки робота',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Удалены поля «Фраза неудачи» и «Ссылка на фразу неудачи» из настроек сценария уборки (ограничение API: нет ИК-датчиков — используется тайм-аут)',
          'Синхронизация с Admin Panel v1.8',
        ],
      },
    ],
  },
  {
    version: '1.5',
    date: '2026-02-17',
    status: 'released',
    changes: [
      {
        page: 'Выбор робота',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Двустрочное отображение имени робота: псевдоним + имя в NE (мелким серым)',
          'Утилита форматирования имени робота для единообразия во всех экранах',
        ],
      },
      {
        page: 'Статус робота',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Двустрочное отображение имени (аналогично экрану выбора)',
        ],
      },
      {
        page: 'Главный экран',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Баннер раздачи и индикатор маркетинга используют двойное имя робота',
        ],
      },
      {
        items: [
          'Confirm-модалки используют единый формат имени робота',
          'Toast отправки/завершения — формат «Сценарий — Робот — статус»',
          'Mock-данные обновлены: добавлены ne_name и alias для всех роботов',
          'Добавлены 4 новые ячейки в каталог (примеры двойного имени)',
        ],
      },
    ],
  },
  {
    version: '1.4',
    date: '2026-02-16',
    status: 'released',
    changes: [
      {
        page: 'Выбор робота',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Новое модальное окно выбора робота с 4 состояниями',
          'Повторяющиеся уведомления (E-STOP, OBSTACLE) с бейджем «ПОВТОРНО» и авто-повтором через 3 секунды',
          'Дедупликация задач уборки в смешанном режиме',
        ],
      },
      {
        page: 'Статус робота',
        pageRoute: '/prototype/front-pudu-plugin/pos',
        items: [
          'Новое модальное окно статуса робота',
          'Модальное окно завершения задачи',
        ],
      },
      {
        page: 'Главный экран',
        pageRoute: '/prototype/front-pudu-plugin',
        items: [
          'Контекст: статус робота и уведомления при запуске',
          'Fire-and-forget паттерн: 6 цепочек обновлены, 2 новых добавлены',
        ],
      },
      {
        items: [
          'Расширена тёмная тема POS: новые UI-паттерны',
          'Зарегистрированы новые иконки (Send, Activity)',
          'Добавлены 8 ячеек в каталог и 8 сценарных цепочек',
        ],
      },
    ],
  },
  {
    version: '1.0',
    date: '2026-02-16',
    status: 'released',
    changes: [
      {
        items: [
          'Начальная версия прототипа',
          'Плагин PUDU для Front',
          'Экраны управления роботами из Front-интерфейса',
        ],
      },
    ],
  },
];
